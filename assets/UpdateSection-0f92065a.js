import{u as K,a as V,r as l,w as J,j as e,V as U,B as k,y as g,T as O,aY as R,aP as Q,a3 as W,aQ as Y}from"./index-d0bb2854.js";import{L as Z}from"./chunk-JMCRK7ZE-6c950521.js";import{A as q}from"./chunk-VJ54TX72-910cf7bc.js";import{M as X,a as _,b as $,c as ee,d as ae,e as te}from"./chunk-PVJ72NKC-aa1299e5.js";import{M as ne}from"./chunk-YLPWWAYV-3e832c2d.js";import{C as ie}from"./chunk-3V5HNFOM-3d294e74.js";import{F as c}from"./chunk-IJBC3YLI-6ce3e25a.js";import{F as d}from"./chunk-RN6VKE3K-a344299b.js";import{S as se}from"./chunk-GJO77I2I-6bc2c4b6.js";import{I as u}from"./chunk-GYFRIY2Z-bed9457d.js";import{T as re}from"./chunk-OEQDSMWZ-a5ca4fb9.js";import{I as oe}from"./chunk-6XCF7NSR-7b933f42.js";import{I as le}from"./chunk-J356FWKS-1260d6a8.js";import"./chunk-LB6CWFOC-afb3a818.js";import"./index-eaa72e81.js";const Ae=()=>{const{state:F}=K(),j=V(),{post:r}=F,[o,m]=l.useState({title:r.title,description:r.description,category:r.category,imageUrlMiniatura:r.imageUrlMiniatura,imageUrlPrincipal:r.imageUrlPrincipal,youtubeLink:r.youtubeLink,contenidos:r.contenidos||[]}),[C,f]=l.useState(),[I,b]=l.useState(),[y,S]=l.useState(),[T,M]=l.useState(),[w,x]=l.useState(!1),{isOpen:N,onOpen:A,onClose:v}=J(),[P,L]=l.useState(),h=t=>{const{name:a,value:n}=t.target;m({...o,[a]:n})};l.useEffect(()=>{console.log(JSON.stringify(r,null,5))},[r]);const D=t=>{const a=t.target.files?t.target.files[0]:null;if(a){f(a);const n=a.name;b(n)}},E=t=>{const a=t.target.files?t.target.files[0]:null;if(a){S(a);const n=a.name;M(n)}},B=(t,a,n)=>{m(s=>{const i=[...s.contenidos];return i[t]={...i[t],[a]:n},{...s,contenidos:i}})},G=(t,a,n)=>{m(s=>{const i=[...s.contenidos],p=[...i[t].detalle];return p[a]=n,i[t]={...i[t],detalle:p},{...s,contenidos:i}})},z=t=>{m(a=>{const n=[...a.contenidos];return n[t]={...n[t],detalle:[...n[t].detalle||[],""]},{...a,contenidos:n}})},H=async t=>{t.preventDefault(),x(!0);try{const a=C?await R(C,I,"blogFolder"):o.imageUrlMiniatura,n=y?await R(y,T,"blogFolder"):o.imageUrlPrincipal,s={...o,imageUrlMiniatura:a,imageUrlPrincipal:n};s.contenidos=o.contenidos.map(p=>({subtitulo:p.subtitulo,detalle:p.detalle||[]}));const i=Q(W,"blogPost",r.id);await Y(i,s),x(!1),L(!0),A(),m({title:"",description:"",category:"Guía de plantas",imageUrlMiniatura:"",imageUrlPrincipal:"",youtubeLink:"",contenidos:[]}),f(null),b(""),S(null),M("")}catch(a){console.error("Error al cargar la imagen:",a),x(!1),L(!1),A()}};return e.jsxs(U,{minH:"calc(100vh - 64px)",bgColor:"gray.100",p:4,children:[e.jsxs(k,{children:[e.jsx(g,{onClick:()=>j("/admin/blog-create"),children:"CARGAR ARTICULO"}),e.jsx(g,{onClick:()=>j("/admin/blog-show"),children:"MOSTRAR ARTICULOS"})]}),e.jsx(e.Fragment,{children:e.jsxs(X,{onClose:v,isOpen:N,isCentered:!0,children:[e.jsx(_,{}),e.jsxs($,{children:[e.jsx(ee,{children:P?"Publicado correctamente!":"Ocurrio un error"}),e.jsx(ne,{}),e.jsx(ae,{children:P?"Publicado correctamente en su blog!":"Ocurrio un error al intentar publicar!"}),e.jsx(te,{children:e.jsx(g,{onClick:v,children:"Cerrar"})})]})]})}),e.jsx(ie,{bg:"white",p:[6,8],borderRadius:"lg",w:["sm","md","xl","3xl"],children:e.jsx("form",{onSubmit:H,children:e.jsxs(U,{spacing:4,children:[e.jsx(O,{fontSize:"xl",as:"b",children:"ACTUALIZAR ARTICULO"}),e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Categoría"}),e.jsxs(se,{name:"category",value:o.category,onChange:h,children:[e.jsx("option",{value:"Guía de plantas",children:"Guía de plantas"}),e.jsx("option",{value:"Cuidado de plantas",children:"Cuidado de plantas"}),e.jsx("option",{value:"Consejos y trucos",children:"Consejos y trucos"}),e.jsx("option",{value:"Conocimientos sobre plantas",children:"Conocimientos sobre plantas"})]})]}),e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Título"}),e.jsx(u,{type:"text",name:"title",value:o.title,onChange:h})]}),e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Descripción"}),e.jsx(re,{name:"description",value:o.description,onChange:h})]}),e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Seleccionar imagen miniatura"}),e.jsx(u,{type:"file",name:"imagenMiniatura",accept:".jpg, .jpeg, .png",onChange:D})]}),e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Seleccionar imagen principal"}),e.jsx(u,{type:"file",name:"imagenPrincipal",accept:".jpg, .jpeg, .png",onChange:E})]}),o.contenidos.map((t,a)=>e.jsxs(k,{width:"100%",borderWidth:"1px",borderRadius:"md",p:"4",children:[e.jsxs(c,{style:{margin:"10px 0"},children:[e.jsx(d,{children:"Subtítulo"}),e.jsx(u,{type:"text",value:t.subtitulo,onChange:n=>B(a,"subtitulo",n.target.value)})]}),(t.detalle||[]).map((n,s)=>e.jsxs(c,{children:[e.jsx(d,{children:"Detalle"}),e.jsx(u,{type:"text",value:n,onChange:i=>G(a,s,i.target.value)})]},s)),e.jsx(g,{leftIcon:e.jsx(q,{}),colorScheme:"gray",variant:"outline",sx:{width:"100%"},onClick:()=>z(a),children:"Agregar detalle"})]},a)),e.jsxs(c,{style:{margin:"20px 0",marginTop:"30px"},children:[e.jsx(d,{children:"Link de video de youtube"}),e.jsxs(oe,{children:[e.jsx(le,{pointerEvents:"none",children:e.jsx(Z,{color:"black"})}),e.jsx(u,{type:"text",name:"youtubeLink",value:o.youtubeLink,onChange:h})]})]}),w?e.jsx(O,{fontSize:"xl",as:"b",children:"Cargando..."}):e.jsx(g,{colorScheme:"teal",sx:{width:"100%"},type:"submit",children:"Actualizar artículo"})]})})})]})};export{Ae as default};
