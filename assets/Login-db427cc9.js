import{r as u,w as se,ac as z,v as T,aa as k,ab as h,j as e,y as p,a9 as b,A as O,bd as H,be as N,F as oe,bf as ae,bg as re,a as te,B as D,W as ie,I as le,S as ne,H as E,T as P,x as ce,aN as de,bh as me,bi as ue}from"./index-d0bb2854.js";import{u as W,o as G,F as x}from"./yup-b18650ce.js";import{A as he,a as pe}from"./chunk-BPJV7R7V-f60e18c4.js";import{a as xe,c as ge,d as je,e as be}from"./chunk-PVJ72NKC-aa1299e5.js";import{M as fe}from"./chunk-YLPWWAYV-3e832c2d.js";import{R as ve,a as Q}from"./chunk-MEU4ZZ42-6778153b.js";import{F as n}from"./chunk-IJBC3YLI-6ce3e25a.js";import{F as c}from"./chunk-RN6VKE3K-a344299b.js";import{I as g}from"./chunk-GYFRIY2Z-bed9457d.js";import{a as _}from"./chunk-J356FWKS-1260d6a8.js";import{I as V}from"./chunk-6XCF7NSR-7b933f42.js";import{S as Ce}from"./chunk-GJO77I2I-6bc2c4b6.js";import{C as we}from"./chunk-SRMZVY4F-2b1e74d1.js";import{D as B}from"./chunk-YGVX4ESO-768d0041.js";import"./chunk-LB6CWFOC-afb3a818.js";import"./index-eaa72e81.js";const Se=()=>{const[i,C]=u.useState(!0),[s,d]=u.useState(0),[w,S]=u.useState("¿Cuál es tu color favorito?"),[a,j]=u.useState("email"),t=u.useRef(),{isOpen:y,onClose:f,onOpen:F}=se(),l=z(),[m]=T("(min-width: 800px)"),$=()=>s<=3&&d(r=>r+1),Z=()=>s>=0&&d(r=>r-1),J=()=>j(a==="email"?"emailQuestion":"email"),K=({target:r})=>S(r.value),U=k().shape({email:h().email("El email no es válido").required("El correo es requerido"),securitySelect:h().required("La pregunta de seguridad no puede estar vacía"),newPassword:h().required("Debes ingresar una nueva contraseña").matches(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?])/,"La contraseña debe contener al menos 1 letra minúscula, 1 letra mayúscula, 1 número y 1 caracter especial").min(6,"La contraseña debe tener mínimo 6 caracteres")}),X=k().shape({email:h().email("El email no es válido").required("El correo es requerido")}),{handleSubmit:I,register:v,reset:q,formState:{errors:o,isSubmitting:Y}}=W({resolver:G(a==="email"?X:U)}),L=async({email:r,securityQuestion:R=w,securitySelect:M,newPassword:A})=>{await ae({email:r,securityQuestion:R,securitySelect:M,newPassword:A}).then(()=>{console.log({email:r,securityQuestion:R,securitySelect:M,newPassword:A}),l({status:"success",duration:1500,isClosable:!1,title:"Recuperación de contraseña",position:m?"top-right":"bottom",description:"Hemos actualizado tu contrasñea"}),q()}).catch(()=>{l({status:"error",duration:1500,isClosable:!1,title:"Recuperación de contraseña",position:m?"top-right":"bottom",description:"Respuesta incorrecta"})})},ee=async r=>{try{await re(r),l({status:"success",duration:1500,isClosable:!1,title:"Recuperación de contraseña",position:m?"top-right":"bottom",description:"Correo enviado exitosamente"}),q(),f()}catch{l({status:"error",duration:1500,isClosable:!1,title:"Recuperación de contraseña",position:m?"top-right":"bottom",description:"Algo salió mal"})}};return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"link",colorScheme:"blue",onClick:F,children:"Olvidé mi contraseña"}),e.jsx(he,{isOpen:y,onClose:f,leastDestructiveRef:t,size:["xs","sm","md","lg","xl"],children:e.jsx(xe,{children:e.jsxs(pe,{children:[e.jsx(ge,{fontSize:"lg",fontWeight:"bold",children:"Recuperar contraseña"}),e.jsx(fe,{}),e.jsxs(je,{children:[s===0&&e.jsx(ve,{onChange:J,value:a,children:e.jsxs(b,{children:[e.jsx(Q,{value:"email",children:"Correo electrónico"}),e.jsx(Q,{value:"emailQuestion",children:"Correo electrónico y pregunta de seguridad"})]})}),s===1&&a==="email"&&e.jsxs(n,{isInvalid:!!o.email,children:[e.jsx(c,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(g,{autoComplete:"false",type:"email",id:"email",placeholder:"correo@electronico.com",...v("email")}),o.email&&e.jsx(x,{children:o.email.message})]}),a==="emailQuestion"&&e.jsxs("form",{onSubmit:I(L),children:[s===1&&e.jsxs(n,{isInvalid:!!o.email,children:[e.jsx(c,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(g,{autoComplete:"false",type:"email",id:"email",placeholder:"correo@electronico.com",...v("email")}),o.email&&e.jsx(x,{children:o.email.message})]}),s===2&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{children:[e.jsx(c,{htmlFor:"securityQuestion",children:"Pregunta de seguridad"}),e.jsxs(Ce,{bgColor:"white",defaultValue:"¿Cuál es tu color favorito?",onChange:K,children:[e.jsx("option",{value:"¿Cuál es tu color favorito?",children:"¿Cuál es tu color favorito?"}),e.jsx("option",{value:"¿Cuál es tu película favorita?",children:"¿Cuál es tu película favorita?"}),e.jsx("option",{value:"¿Cuál es tu equipo de fútbol favorito?",children:"¿Cuál es tu equipo de fútbol favorito?"}),e.jsx("option",{value:"¿Cuál es tu género de música favorito?",children:"¿Cuál es tu género de música favorito?"}),e.jsx("option",{value:"¿Cuál es el nombre de tu mascota?",children:"¿Cuál es el nombre de tu mascota?"})]})]}),e.jsxs(n,{isInvalid:!!o.securitySelect,mt:4,children:[e.jsx(c,{htmlFor:"securitySelect",children:"Respuesta"}),e.jsx(g,{autoComplete:"false",type:"text",id:"securitySelect",bgColor:["white","transparent"],borderColor:"gray.200",placeholder:"Tu respuesta aquí...",...v("securitySelect")}),o.securitySelect&&e.jsx(x,{children:o.securitySelect.message})]})]}),s===3&&e.jsx(e.Fragment,{children:e.jsxs(n,{isInvalid:!!o.newPassword,children:[e.jsx(c,{htmlFor:"newPassword",children:"Nueva contraseña"}),e.jsxs(V,{children:[e.jsx(_,{children:e.jsx(O,{variant:"link","aria-label":"Show password",icon:i?e.jsx(H,{}):e.jsx(N,{}),onClick:()=>C(!i)})}),e.jsx(g,{autoComplete:"false",type:i?"password":"text",id:"password",bgColor:["white","transparent"],placeholder:"********",borderColor:"gray.200",...v("newPassword")})]}),o.newPassword&&e.jsx(x,{children:o.newPassword.message})]})})]})]}),e.jsx(be,{children:e.jsxs(oe,{direction:["column","column","column","row"],width:"100%",gap:1.5,children:[e.jsx(p,{width:"100%",colorScheme:"red",type:"button",onClick:Z,isDisabled:s===0,children:"Anterior"}),e.jsx(p,{marginInlineStart:0,width:"100%",colorScheme:"blue",onClick:$,isDisabled:s===3||a==="email"&&s===1,children:"Siguiente"}),(s===3||a==="email"&&s===1)&&e.jsx(p,{marginInlineStart:0,colorScheme:"purple",width:"100%",isLoading:Y,onClick:I(a==="email"?ee:L),children:a==="email"?"Enviar correo":"Actualizar contraseña"})]})})]})})})]})},Oe=()=>{const[i,C]=u.useState(!0),s=z(),[d]=T("(min-width: 800px)"),w=te(),S=k().shape({email:h().required("El correo es requerido").email("Debe ser un correo válido"),password:h().required("La contraseña es requerida").min(6,"La contraseña debe tener mínimo 6 caracteres")}),{handleSubmit:a,register:j,formState:{errors:t,isSubmitting:y},reset:f}=W({resolver:G(S)}),F=async l=>{try{await ue(l.email,l.password),s({status:"success",duration:1500,isClosable:!1,title:"Inicio de sesión",position:d?"top-right":"bottom",description:"¡Bienvenido de vuelta!"}),f(),w(-1)}catch(m){s({status:"error",duration:1500,isClosable:!1,title:"Inicio de sesión",position:d?"bottom":"top-right",description:m})}};return e.jsxs(D,{bgColor:"gray.100",minHeight:"100vh",children:[e.jsx(ie,{children:e.jsx("title",{children:"Iniciar sesión"})}),e.jsx(we,{maxW:"lg",py:{base:"12",md:"24"},px:{base:"0",sm:"8"},children:e.jsxs(b,{spacing:"8",children:[e.jsxs(b,{spacing:"6",children:[d&&e.jsx(le,{src:{}.VITE_ADMIN_LOGIN_IMAGE??"https://firebasestorage.googleapis.com/v0/b/xochicalli-commerce.appspot.com/o/assets%2Flogo.png?alt=media&token=b5a9e3c5-d9f1-469c-9c9d-9af0c5f1cfd9",alt:"Top Image",objectFit:"cover",fallbackSrc:"https://via.placeholder.com/256",loading:"lazy",width:"128px",borderRadius:"lg",mx:"auto"}),e.jsxs(b,{spacing:{base:"2",md:"3"},textAlign:"center",children:[e.jsx(ne,{size:{base:"xl",md:"lg"},children:"Iniciar sesión"}),e.jsxs(E,{spacing:"1",justify:"center",children:[e.jsx(P,{color:"muted",children:"¿No tienes cuenta?"}),e.jsx(p,{variant:"link",as:ce,to:"/signup",colorScheme:"blue",children:"Registrarme"})]})]})]}),e.jsx(D,{py:{base:"0",sm:"8"},px:{base:"4",sm:"10"},bg:{base:"transparent",sm:"white"},boxShadow:{base:"none",sm:"md"},borderRadius:{base:"none",sm:"xl"},children:e.jsxs(b,{spacing:"6",children:[e.jsxs("form",{onSubmit:a(F),children:[e.jsxs(n,{isInvalid:!!t.email,children:[e.jsx(c,{htmlFor:"email",children:"Correo electrónico"}),e.jsx(g,{autoComplete:"false",type:"email",id:"email",bgColor:["white","transparent"],placeholder:"correo@electronico.com",borderColor:"gray.200",...j("email")}),t.email&&e.jsx(x,{children:t.email.message})]}),e.jsxs(n,{isInvalid:!!t.password,mt:4,children:[e.jsx(c,{htmlFor:"password",children:"Contraseña"}),e.jsxs(V,{children:[e.jsx(_,{children:e.jsx(O,{variant:"link","aria-label":"Show password",icon:i?e.jsx(H,{}):e.jsx(N,{}),onClick:()=>C(!i)})}),e.jsx(g,{autoComplete:"false",type:i?"password":"text",id:"password",bgColor:["white","transparent"],placeholder:"********",borderColor:"gray.200",...j("password")})]}),t.password&&e.jsx(x,{children:t.password.message})]}),e.jsx(E,{alignItems:"right",mt:4,mb:1,justifyContent:"flex-end",children:e.jsx(Se,{})}),e.jsx(de,{pt:4,width:"100%",colorScheme:"green",children:e.jsx(p,{type:"submit",isLoading:y,width:"100%",children:"Iniciar sesión"})})]}),e.jsxs(E,{children:[e.jsx(B,{borderColor:["gray.400","gray.200"]}),e.jsx(P,{fontSize:"sm",whiteSpace:"nowrap",color:"muted",children:"O ingresa con:"}),e.jsx(B,{borderColor:["gray.400","gray.200"]})]}),e.jsx(me,{})]})})]})})]})};export{Oe as default};
