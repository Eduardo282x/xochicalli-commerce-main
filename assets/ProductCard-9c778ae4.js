import{r as c,U as y,t as R,ac as I,v as T,a as U,j as e,B as s,T as d,y as k,D as L}from"./index-d0bb2854.js";import{u as P}from"./usePrice-1387bd08.js";const O=t=>{const p=localStorage.getItem("uid"),{user:b}=c.useContext(y),{addToCart:g}=c.useContext(R),f=I(),[x]=T("(min-width: 800px)"),u=U(),{newPrice:j}=P(t.price),C=()=>u(`/products/${t.id}`),S=()=>{!b||p===""?(f({status:"info",duration:1500,isClosable:!1,title:"Añadir al carrito",position:x?"top-right":"bottom",description:"Debes iniciar sesión para añadir productos al carrito"}),u("/login")):(t&&g(t),f({status:"success",duration:1e3,isClosable:!1,title:"Añadir al carrito",position:x?"top":"bottom",description:"¡Producto añadido al carrito!"}))},[w,r]=c.useState(null);console.log("offlineSrc::>",w),c.useEffect(()=>{const i=async()=>{const n=await caches.match(t.image);if(console.log("%ccacheResponse","color:red",n),n){const o=await n.blob(),a=URL.createObjectURL(o);console.log("offlineSrc2::>",a),r(a)}};(async()=>{try{const o=await(await fetch(t.image)).blob(),a=URL.createObjectURL(o);r(a)}catch{const o=await caches.match(t.image);if(o){const a=await o.blob(),m=URL.createObjectURL(a);console.log("offlineSrc2::>",m),r(m)}}})(),i()},[t.image]);function h(i,l){return i.length>l?i.slice(0,l):i}return e.jsx(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsxs(s,{h:"auto",w:"auto",onClick:C,border:"2px solid #e2e8f0",borderRadius:"md",overflow:"hidden",children:[e.jsx(s,{sx:{display:"flex",width:"256px",height:"256px",backgroundImage:`url('${t.image}')`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",justifyContent:"flex-end",alignItems:"flex-end"}}),e.jsxs(s,{children:[e.jsx(s,{px:2,children:e.jsx(d,{fontSize:"2xl",as:"b",children:h(t.title,20)})}),e.jsxs(s,{sx:{display:"flex",width:"100%",justifyContent:"space-between"},px:2,children:[e.jsx(d,{fontSize:"md",children:h(t.description,20)}),e.jsxs(d,{fontSize:"2xl",as:"b",sx:{marginTop:"-9px"},children:[j," "]})]})]}),e.jsx(s,{sx:{display:"flex",width:"100%",justifyContent:"center",my:".5rem"},children:e.jsx(k,{sx:{width:"100%",mx:".5rem"},leftIcon:e.jsx(L,{size:22}),onClick:S,colorScheme:"purple"})})]})})};export{O as default};
